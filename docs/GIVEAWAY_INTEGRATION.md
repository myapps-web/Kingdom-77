# ๐ Giveaway System Integration Guide

**Kingdom-77 Bot v4.0**

---

## ๐ ุงูุชูุงูู ูุน main.py

### ุงูุฎุทูุฉ 1: ุชุญุฏูุซ main.py

ุฃุถู ุงูููุฏ ุงูุชุงูู ูู `main.py`:

```python
# ูู ุงูุจุฏุงูุฉ - Imports
from database.giveaway_schema import init_giveaway_schema

# ูู ุฏุงูุฉ setup_database()
async def setup_database():
    """ุชููุฆุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช"""
    try:
        # ... ุงูููุฏ ุงูุญุงูู ...
        
        # ุชููุฆุฉ Giveaway Schema
        bot.giveaway_db = await init_giveaway_schema(bot.db)
        print("โ Giveaway database initialized")
        
    except Exception as e:
        print(f"โ Database setup error: {e}")

# ูู ุฏุงูุฉ load_cogs()
async def load_cogs():
    """ุชุญููู ุงูู cogs"""
    cogs = [
        # ... ุงูู cogs ุงูุญุงููุฉ ...
        "cogs.cogs.giveaway",  # โ ุฅุถุงูุฉ ูุฐุง ุงูุณุทุฑ
    ]
    
    for cog in cogs:
        try:
            await bot.load_extension(cog)
            print(f"โ Loaded: {cog}")
        except Exception as e:
            print(f"โ Failed to load {cog}: {e}")
```

---

## ๐๏ธ MongoDB Setup

### ุฅูุดุงุก Collections ุชููุงุฆูุงู

ุนูุฏ ุชุดุบูู ุงูุจูุช ูุฃูู ูุฑุฉุ ุณูุชู ุฅูุดุงุก:

```javascript
// Collections
db.giveaways
db.giveaway_settings

// Indexes
db.giveaways.createIndex({ "giveaway_id": 1 }, { unique: true })
db.giveaways.createIndex({ "guild_id": 1 })
db.giveaways.createIndex({ "guild_id": 1, "status": 1 })
db.giveaways.createIndex({ "message_id": 1 })
db.giveaways.createIndex({ "end_time": 1 })
db.giveaways.createIndex({ "status": 1, "end_time": 1 })

db.giveaway_settings.createIndex({ "guild_id": 1 }, { unique: true })
```

---

## โ๏ธ Environment Variables

ูุง ุชูุฌุฏ ูุชุบูุฑุงุช ุจูุฆุฉ ุฅุถุงููุฉ ูุทููุจุฉ! ๐

ูุธุงู Giveaway ูุนูู ูุจุงุดุฑุฉ ูุน:
- โ MongoDB (ููุฌูุฏ)
- โ Discord Bot Token (ููุฌูุฏ)

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### 1. ุงุฎุชุจุงุฑ ุงูุฅูุดุงุก

```
/giveaway create channel:#test
```

**ูุง ูุฌุจ ุฃู ูุญุฏุซ:**
- โ Modal ูุธูุฑ
- โ ุจุนุฏ ุงูุฅุฑุณุงู: ุณุคุงู ุนู Entities
- โ ุฑุณุงูุฉ ุงููุฑุนุฉ ุชุธูุฑ ูู ุงูููุงุฉ
- โ ุฒุฑ "ุฏุฎูู ุงููุฑุนุฉ" ูุนูู

### 2. ุงุฎุชุจุงุฑ Entities

```
/giveaway create channel:#test
โ Modal: Prize, Duration, Winners
โ ุงุฎุชุฑ: ูุนูุ ุชูุนูู Entities
โ Modal: Mode, Roles, Points
โ ุฅุถุงูุฉ ุฑุชุจ ุฅุถุงููุฉ (ุงุฎุชูุงุฑู)
โ ุฅููุงุก
```

**ูุง ูุฌุจ ุฃู ูุญุฏุซ:**
- โ Embed ูุนุฑุถ ูุนูููุงุช Entities
- โ ุนูุฏ ุงูุฏุฎูู: ุฑุณุงูุฉ ุชุนุฑุถ ุงูููุงุท ุงูููุชุณุจุฉ
- โ ุฅุญุตุงุฆูุงุช Entities ุธุงูุฑุฉ ูู `/giveaway info`

### 3. ุงุฎุชุจุงุฑ ุงูุฏุฎูู

```
ุงุถุบุท ุฒุฑ "ุฏุฎูู ุงููุฑุนุฉ"
```

**ูุง ูุฌุจ ุฃู ูุญุฏุซ:**
- โ ุฑุณุงูุฉ: "ุชู ุชุณุฌูู ุฏุฎููู!"
- โ ุฅุฐุง ูุฏูู Entities: "ููุงูุฃุฉ Entities: +X% ูุฑุตุฉ ููุฒ!"
- โ ุนุฏุงุฏ ุงููุดุงุฑููู ูุฒูุฏ
- โ ูุง ูููู ุงูุฏุฎูู ูุฑุชูู

### 4. ุงุฎุชุจุงุฑ ุงูุฅููุงุก

```
/giveaway end giveaway_id:<id>
```

**ูุง ูุฌุจ ุฃู ูุญุฏุซ:**
- โ ูุฎุชุงุฑ ูุงุฆุฒูู ุนุดูุงุฆูุงู
- โ Embed ููุญุฏูุซ: "ุงูุชูุช ุงููุฑุนุฉ!"
- โ ุฑุณุงูุฉ ุฅุนูุงู ุงููุงุฆุฒูู
- โ DM ูููุงุฆุฒูู (ุฅุฐุง ููุนูู)

### 5. ุงุฎุชุจุงุฑ Background Task

ุงูุชุธุฑ ุญุชู ุชูุชูู ูุฑุนุฉ ุชููุงุฆูุงู...

**ูุง ูุฌุจ ุฃู ูุญุฏุซ:**
- โ ุจุนุฏ ุงูุชูุงุก ุงููุฏุฉ (30 ุซุงููุฉ check)
- โ ุงูุจูุช ูููู ุงููุฑุนุฉ ุชููุงุฆูุงู
- โ ููุณ ุงููุชุงุฆุฌ ูุฃูู ุงุณุชุฎุฏูุช `/giveaway end`

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุดููุฉ: Modal ูุง ูุธูุฑ

**ุงูุญู:**
```python
# ุชุฃูุฏ ูู ุฃู ุงูุจูุช ูุฏูู ุตูุงุญูุงุช:
- Use Slash Commands
- Send Messages
- Embed Links
- Add Reactions
```

### ูุดููุฉ: Background task ูุง ูุนูู

**ุงูุญู:**
```python
# ูู cog __init__:
self.check_giveaways_task.start()

# ูู cog_unload:
self.check_giveaways_task.cancel()
```

### ูุดููุฉ: Entities ูุง ุชุญุณุจ ุตุญูุญ

**ุงูุญู:**
```python
# ุชุฃูุฏ ูู:
1. role_entities ุตุญูุญุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. ุงูุนุถู ูุฏูู ุงูุฑุชุจ ูุนูุงู
3. mode = "cumulative" ุฃู "highest" (lowercase)
```

### ูุดููุฉ: DM ูุง ููุฑุณูู

**ุงูุญู:**
```python
# ุงููุณุชุฎุฏู ูุฏ ูููู:
1. ุฃุบูู DMs ูู ุงูุณูุฑูุฑ
2. ุญุธุฑ ุงูุจูุช
3. ูุฏูู privacy settings ุนุงููุฉ

# ุงูุจูุช ูุชุฌุงูู ุงูุฎุทุฃ ููููู
```

---

## ๐ ูุฑุงูุจุฉ ุงูุฃุฏุงุก

### Logs ูููุฉ

```python
# ูู console ุณุชุดุงูุฏ:
โ Giveaway database initialized
โ Loaded: cogs.cogs.giveaway
โ Background task started

# ุนูุฏ ุฅูุดุงุก ูุฑุนุฉ:
[Giveaway] Created: prize="Nitro" guild=123456789

# ุนูุฏ ุฅููุงุก ูุฑุนุฉ:
[Giveaway] Ended: giveaway_id=abc123 winners=3

# ุนูุฏ ุฎุทุฃ:
[ERROR] Giveaway task error: <error details>
```

### MongoDB Queries

```javascript
// ุนุฑุถ ุฌููุน ุงููุฑุนุงุช ุงููุดุทุฉ
db.giveaways.find({ status: "active" })

// ุนุฑุถ ูุฑุนุฉ ูุนููุฉ
db.giveaways.findOne({ giveaway_id: "abc123xyz" })

// ุฅุญุตุงุฆูุงุช ุณูุฑูุฑ
db.giveaway_settings.findOne({ guild_id: "123456789" })

// ุนุฏุฏ ุงููุฑุนุงุช ุงูููู
db.giveaways.countDocuments()
```

---

## ๐ง Customization

### ุชุบููุฑ Check Interval

```python
# ูู cogs/cogs/giveaway.py
@tasks.loop(seconds=30)  # โ ุบููุฑ ููุง (ุงูุชุฑุงุถู: 30 ุซุงููุฉ)
async def check_giveaways_task(self):
    ...
```

**ุชูุตูุงุช:**
- โ๏ธ ูุง ุชูู ุนู 10 ุซูุงูู (ุญูู ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช)
- โ 30 ุซุงููุฉ ููุงุณุจ (ุงูุชุฑุงุถู)
- โก 60 ุซุงููุฉ ููุจูุชุงุช ุงููุจูุฑุฉ

### ุชุบููุฑ Entities Ratio

```python
# ูู giveaway/giveaway_system.py
# ูู ุฏุงูุฉ add_entry():

bonus_entries = entities_points  # โ 1:1 ratio (ุงูุชุฑุงุถู)

# ููููู ุชุบููุฑูุง ุฅูู:
bonus_entries = entities_points * 2  # 1:2 ratio (ุฃููู)
bonus_entries = entities_points // 2  # 1:0.5 ratio (ุฃุถุนู)
```

### ุชุบููุฑ Max Points

```python
# ูู database/giveaway_schema.py
"points": {
    "bsonType": "int",
    "minimum": 1,
    "maximum": 100  # โ ุบููุฑ ููุง
}
```

---

## ๐ฑ ุงูุงุณุชุฎุฏุงู ุงููููู

### ูููุฏูุฑูู

```bash
# ุตุจุงุญ ูู ููู
/giveaway list status:active
# โ ุชุญูู ูู ุงููุฑุนุงุช ุงููุดุทุฉ

# ุนูุฏ ุงูุชูุงุก ูุฑุนุฉ ูููุฉ
/giveaway info giveaway_id:<id>
# โ ุฑุงุฌุน ุงูุฅุญุตุงุฆูุงุช

# ุฅุฐุง ุงููุงุฆุฒ ูู ูุฑุฏ
/giveaway reroll giveaway_id:<id>
# โ ุงุฎุชุฑ ูุงุฆุฒ ุฌุฏูุฏ
```

### ููุฃุนุถุงุก

```bash
# ุตุจุงุญ ูู ููู
/giveaway list
# โ ุดุงูุฏ ุงููุฑุนุงุช ุงูุฌุฏูุฏุฉ

# ุงุถุบุท "ุฏุฎูู ุงููุฑุนุฉ" ๐
# โ ุงุฏุฎู ูู ูู ุงููุฑุนุงุช!
```

---

## ๐ Best Practices

### 1. ุฅุนุฏุงุฏ Entities ุจุญููุฉ

โ **ุงูุนู:**
- ุถุน ููุงุท ุฃุนูู ููุฑุชุจ ุงููููุฉ (VIP, Booster)
- ุงุณุชุฎุฏู `cumulative` ูููุงูุฃุฉ ุงููุดูุทูู
- ุงุณุชุฎุฏู `highest` ูุชุญุฏูุฏ ุฃููููุงุช ูุงุถุญุฉ

โ **ูุง ุชูุนู:**
- ุชุถุน ููุงุท ูุชุณุงููุฉ ููุฌููุน
- ุชุณุชุฎุฏู ููุงุท ุนุงููุฉ ุฌุฏุงู (ููู 50) ุฅูุง ููุฑุชุจ ุงูุฎุงุตุฉ
- ุชุถุน ุฃูุซุฑ ูู 20 ุฑุชุจุฉ

### 2. ูุฏุฉ ุงููุฑุนุงุช

| ุงููุฏุฉ | ุงูุงุณุชุฎุฏุงู |
|-------|-----------|
| 30m - 2h | ูุฑุนุงุช ุณุฑูุนุฉุ ุฌูุงุฆุฒ ุตุบูุฑุฉ |
| 12h - 1d | ูุฑุนุงุช ููููุฉุ ุฌูุงุฆุฒ ูุชูุณุทุฉ |
| 3d - 7d | ูุฑุนุงุช ูุจูุฑุฉุ ุฌูุงุฆุฒ ุถุฎูุฉ |

### 3. ุนุฏุฏ ุงููุงุฆุฒูู

```
ุฌุงุฆุฒุฉ ุตุบูุฑุฉ โ 1-3 ูุงุฆุฒูู
ุฌุงุฆุฒุฉ ูุชูุณุทุฉ โ 3-5 ูุงุฆุฒูู
ุฌุงุฆุฒุฉ ูุจูุฑุฉ โ 1 ูุงุฆุฒ (ูููุฒ!)
```

### 4. ุงูุดุฑูุท

```python
# ูุฑุนุฉ ููุฌููุน
requirements = {}

# ูุฑุนุฉ ูููุดูุทูู
requirements = {
    "min_level": 10,
    "min_server_join_days": 7
}

# ูุฑุนุฉ ูู VIP ููุท
requirements = {
    "required_roles": ["vip_role_id"]
}
```

---

## ๐ Launch Checklist

ูุจู ุงูุฅุทูุงู ุงูุนุงู ูููุธุงู:

- [ ] ุงุฎุชุจุฑ ุฅูุดุงุก ูุฑุนุฉ ุนุงุฏูุฉ โ
- [ ] ุงุฎุชุจุฑ ุฅูุดุงุก ูุฑุนุฉ ูุน Entities โ
- [ ] ุงุฎุชุจุฑ cumulative mode โ
- [ ] ุงุฎุชุจุฑ highest mode โ
- [ ] ุงุฎุชุจุฑ ุงูุฏุฎูู ูู ูุฑุนุฉ โ
- [ ] ุงุฎุชุจุฑ Entities calculation โ
- [ ] ุงุฎุชุจุฑ ุฅููุงุก ูุฏูู โ
- [ ] ุงุฎุชุจุฑ ุฅููุงุก ุชููุงุฆู (background task) โ
- [ ] ุงุฎุชุจุฑ reroll โ
- [ ] ุงุฎุชุจุฑ cancel โ
- [ ] ุงุฎุชุจุฑ DM notifications โ
- [ ] ุงุฎุชุจุฑ ุฌููุน ุงูุฃูุงูุฑ โ
- [ ] ุฑุงุฌุน ุงูุฏููู ูุน ุงููุฑูู โ
- [ ] ุฃุนูู ุนู ุงูููุฒุฉ ุงูุฌุฏูุฏุฉ! ๐

---

## ๐ข ุงูุฅุนูุงู

### ุฑุณุงูุฉ ููุชุฑุญุฉ ููุฅุนูุงู

```markdown
๐ **ููุฒุฉ ุฌุฏูุฏุฉ: ูุธุงู ุงููุฑุนุงุช ูุน Entities!** โญ

ููุฏู ููู ูุธุงู ูุฑุนุงุช ูุชูุฏู ูุน ููุฒุฉ **Entities** ุงููุฑูุฏุฉ!

**ูุง ูู Entitiesุ**
โข ูุธุงู ููุงุท ูุนุทู ูุฑุต ููุฒ ุฅุถุงููุฉ ุญุณุจ ุฑุชุจู
โข 1 ููุทุฉ = 1% ูุฑุตุฉ ููุฒ ุฅุถุงููุฉ!

**ุงูููุฒุงุช:**
โจ ูุฑุนุงุช ูุฎุตุตุฉ ุจุงููุงูู
โญ ูุธุงู Entities (ูุถุนุงู: ุฅุฌูุงูู / ุฃุนูู ุฑุชุจุฉ)
๐ ุดุฑูุท ูุชุนุฏุฏุฉ (ุฑุชุจุ ูุณุชููุ ูุฑูุฏูุชุ ุนูุฑ)
๐ ุฅุฏุงุฑุฉ ูุงููุฉ (ุฅููุงุกุ ุฅุนุงุฏุฉ ุณุญุจุ ุฅูุบุงุก)
๐ ุฅุญุตุงุฆูุงุช ุดุงููุฉ
๐ ุฅุดุนุงุฑุงุช ุชููุงุฆูุฉ

**ุฌุฑูุจ ุงูุขู:**
`/giveaway create`

**ุงูุฑุฃ ุงูุฏููู ุงููุงูู:** [ุฑุงุจุท]

ูุชููู ููู ุญุธุงู ููููุงู! ๐
```

---

## ๐ฏ Next Steps

ุจุนุฏ ุฅุทูุงู ุงููุธุงู:

1. **ุฌูุน Feedback**
   - ุงุณุฃู ุงููุฏูุฑูู ุนู ุชุฌุฑุจุชูู
   - ุงุณุฃู ุงูุฃุนุถุงุก ุนู ูุถูุญ Entities

2. **ูุฑุงูุจุฉ ุงูุฃุฏุงุก**
   - ุฑุงูุจ ุงุณุชุฎุฏุงู Background task
   - ุชุญูู ูู ุณุฑุนุฉ ุงููุนุงูุฌุฉ

3. **ุชุญุณููุงุช ูุณุชูุจููุฉ**
   - Entities presets
   - Dashboard integration
   - Analytics

---

**Kingdom-77 Bot v4.0** ๐  
**Giveaway System with Entities** ๐โญ

**ุฌุงูุฒ ููุฅุทูุงู!** ๐
