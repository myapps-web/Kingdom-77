# ูุธุงู ุงูุชุญูู ุจุงูุตูุงุญูุงุช ุนุจุฑ ุงูุฑุชุจ - Role-Based Permission System

## ูุธุฑุฉ ุนุงูุฉ / Overview

ุชู ุฅุถุงูุฉ ูุธุงู ุดุงูู ููุชุญูู ูู ุตูุงุญูุงุช ุงูุจูุช ุนุจุฑ ุงูุฑุชุจ. ุงูุขู ูููู ููุงูู ุงูุณูุฑูุฑ ูุงูุฃุฏููุฒ ุชุนููู ุฑุชุจ ูุญุฏุฏุฉ ูููููุง ุฅุฏุงุฑุฉ ุฅุนุฏุงุฏุงุช ุงููุบุงุช ูู ุงููููุงุช.

A comprehensive role-based permission system has been added. Server owners and administrators can now assign specific roles that can manage language settings.

---

## ๐ ูุธุงู ุงูุตูุงุญูุงุช / Permission System

### ุงูุตูุงุญูุงุช ุงูุงูุชุฑุงุถูุฉ / Default Permissions

**ูุฏููู ุตูุงุญูุงุช ูุงููุฉ ุฏุงุฆูุงู:**
- ๐ ูุงูู ุงูุณูุฑูุฑ (Server Owner)
- ๐ก๏ธ ุงูุฃุฏููุณุชุฑูุชูุฑ (Administrator Permission)

**Always have full permissions:**
- ๐ Server Owner
- ๐ก๏ธ Administrator Permission

### ุงูุตูุงุญูุงุช ุงููุฎุตุตุฉ / Custom Permissions

ูููู ููุฃุฏููุฒ ุฅุถุงูุฉ ุฑุชุจ ูุฎุตุตุฉ ุชููุญ ุฃุนุถุงุฆูุง ุงููุฏุฑุฉ ุนูู:
- โ๏ธ ุชุนููู ุงููุบุฉ ุงูุงูุชุฑุงุถูุฉ ูููููุงุช (`/setlang`)
- โ ุญุฐู ุฅุนุฏุงุฏุงุช ุงููุบุฉ (`/removelang`)
- ๐ ุนุฑุถ ุงููุบุฉ ุงููุญุฏุฏุฉ ููููุงุฉ (`/getlang`)

Admins can add custom roles that grant members the ability to:
- โ๏ธ Set default language for channels (`/setlang`)
- โ Remove language settings (`/removelang`)
- ๐ View channel language (`/getlang`)

---

## ๐ ุงูุฃูุงูุฑ ุงูุฌุฏูุฏุฉ / New Commands

### 1. `/addrole` - ุฅุถุงูุฉ ุฑุชุจุฉ ูุณููุญุฉ

**ุงููุตู:** ุฅุถุงูุฉ ุฑุชุจุฉ ุฅูู ูุงุฆูุฉ ุงูุฑุชุจ ุงููุณููุญุฉ ูุฅุฏุงุฑุฉ ุงููุบุงุช
**ุงูุตูุงุญูุฉ ุงููุทููุจุฉ:** ูุงูู ุงูุณูุฑูุฑ ุฃู ุฃุฏููุณุชุฑูุชูุฑ
**ุงููุนุงููุงุช:**
- `role` - ุงูุฑุชุจุฉ ุงููุฑุงุฏ ุฅุถุงูุชูุง

**Usage:**
```
/addrole role:@Moderators
```

**ุงููุฎุฑุฌุงุช / Output:**
```
โ Role Added

Successfully added @Moderators to allowed roles.

Members with this role can now:
โข Set channel languages (/setlang)
โข Remove language settings (/removelang)
โข View channel languages (/getlang)
```

---

### 2. `/removerole` - ุฅุฒุงูุฉ ุฑุชุจุฉ ูุณููุญุฉ

**ุงููุตู:** ุฅุฒุงูุฉ ุฑุชุจุฉ ูู ูุงุฆูุฉ ุงูุฑุชุจ ุงููุณููุญุฉ
**ุงูุตูุงุญูุฉ ุงููุทููุจุฉ:** ูุงูู ุงูุณูุฑูุฑ ุฃู ุฃุฏููุณุชุฑูุชูุฑ
**ุงููุนุงููุงุช:**
- `role` - ุงูุฑุชุจุฉ ุงููุฑุงุฏ ุฅุฒุงูุชูุง

**Usage:**
```
/removerole role:@Moderators
```

**ุงููุฎุฑุฌุงุช / Output:**
```
โ Role Removed

Successfully removed @Moderators from allowed roles.

Members with this role can no longer manage language settings.
```

---

### 3. `/listroles` - ุนุฑุถ ุงูุฑุชุจ ุงููุณููุญุฉ

**ุงููุตู:** ุนุฑุถ ุฌููุน ุงูุฑุชุจ ุงูุชู ูุฏููุง ุตูุงุญูุฉ ุฅุฏุงุฑุฉ ุงููุบุงุช
**ุงูุตูุงุญูุฉ ุงููุทููุจุฉ:** ุฌููุน ุงูุฃุนุถุงุก
**ุงููุนุงููุงุช:** ูุง ููุฌุฏ

**Usage:**
```
/listroles
```

**ุงููุฎุฑุฌุงุช / Output:**
```
๐ Allowed Roles

Roles with language management permissions:

โข @Moderators (Moderators)
โข @Helpers (Helpers)

Also have access:
โข Server Owner
โข Administrator

Total: 2 custom role(s)
```

---

## ๐ง ุงูุชูุงุตูู ุงูุชูููุฉ / Technical Details

### ุงููููุงุช ุงููุนุฏูุฉ / Modified Files

**`main.py`:**
- โ ุฅุถุงูุฉ ุซุงุจุช `ROLES_FILE` ููุณุงุฑ ููู ุงูุฑุชุจ
- โ ุฅุถุงูุฉ ูุงููุณ `allowed_roles` ุนุงู
- โ ุฅุถุงูุฉ ุฏุงูุฉ `load_allowed_roles()` ูุชุญููู ุงูุฑุชุจ
- โ ุฅุถุงูุฉ ุฏุงูุฉ `save_allowed_roles()` ุบูุฑ ูุชุฒุงููุฉ ูุญูุธ ุงูุฑุชุจ
- โ ุฅุถุงูุฉ ุฏุงูุฉ `has_permission()` ููุชุญูู ูู ุงูุตูุงุญูุงุช
- โ ุชุญุฏูุซ ุฌููุน ุงูุฃูุงูุฑ ุงูุฅุฏุงุฑูุฉ ูุงุณุชุฎุฏุงู ุงููุธุงู ุงูุฌุฏูุฏ
- โ ุฅุถุงูุฉ 3 ุฃูุงูุฑ ุฌุฏูุฏุฉ: `/addrole`, `/removerole`, `/listroles`
- โ ุชุญุฏูุซ ุฃูุฑ `/help` ููุนุฑุถ ุงูุฃูุงูุฑ ุงูุฅุฏุงุฑูุฉ ููุฃุฏููุฒ ููุท

**New file created:**
- `allowed_roles.json` - ูุชู ุฅูุดุงุคู ุชููุงุฆูุงู ุนูุฏ ุฃูู ุงุณุชุฎุฏุงู

---

## ๐พ ุชุฎุฒูู ุงูุจูุงูุงุช / Data Storage

### ููู `allowed_roles.json`

**ุงูุตูุบุฉ / Format:**
```json
{
  "guild_id": [
    "role_id_1",
    "role_id_2",
    "role_id_3"
  ],
  "another_guild_id": [
    "role_id_1"
  ]
}
```

**ูุซุงู / Example:**
```json
{
  "1234567890123456789": [
    "9876543210987654321",
    "1111222233334444555"
  ]
}
```

---

## ๐ ููุทู ุงูุชุญูู ูู ุงูุตูุงุญูุงุช / Permission Check Logic

```python
def has_permission(member, guild_id):
    # 1. ูุงูู ุงูุณูุฑูุฑ - ุตูุงุญูุฉ ุฏุงุฆูุฉ
    if member.guild.owner_id == member.id:
        return True
    
    # 2. ุฃุฏููุณุชุฑูุชูุฑ - ุตูุงุญูุฉ ุฏุงุฆูุฉ
    if member.guild_permissions.administrator:
        return True
    
    # 3. ุงูุชุญูู ูู ุงูุฑุชุจ ุงููุฎุตุตุฉ
    if guild_id in allowed_roles:
        if any(str(role.id) in allowed_roles[guild_id] for role in member.roles):
            return True
        return False  # ุฅุฐุง ูุงูุช ููุงู ุฑุชุจ ูุฎุตุตุฉ ููู ูููููุง
    
    # 4. ุงูุชุฑุงุถู: ุตูุงุญูุฉ Manage Channels
    return member.guild_permissions.manage_channels
```

---

## ๐ ุฃูุซูุฉ ุงูุงุณุชุฎุฏุงู / Usage Examples

### ุงูุณููุงุฑูู 1: ุฅุนุฏุงุฏ ูุธุงู ุงูุตูุงุญูุงุช

1. **ุงูุฃุฏูู ููุดุฆ ุฑุชุจุฉ ูููุชุฑุฌููู:**
   - ููุดุฆ ุฑุชุจุฉ ุงุณููุง `@Translators` ูู ุฅุนุฏุงุฏุงุช ุงูุณูุฑูุฑ

2. **ุงูุฃุฏูู ูุถูู ุงูุฑุชุจุฉ ููุจูุช:**
   ```
   /addrole role:@Translators
   ```

3. **ุงูุฃุนุถุงุก ูุน ุฑุชุจุฉ Translators ูุณุชุทูุนูู ุงูุขู:**
   ```
   /setlang channel:#arabic language:Arabic
   /removelang channel:#french
   /getlang channel:#english
   ```

### ุงูุณููุงุฑูู 2: ุฅุฏุงุฑุฉ ุนุฏุฉ ุฑุชุจ

```bash
# ุฅุถุงูุฉ ุฑุชุจ ูุชุนุฏุฏุฉ
/addrole role:@Moderators
/addrole role:@Staff
/addrole role:@Helpers

# ุนุฑุถ ุฌููุน ุงูุฑุชุจ
/listroles

# ุฅุฒุงูุฉ ุฑุชุจุฉ
/removerole role:@Helpers
```

### ุงูุณููุงุฑูู 3: ูุญุต ุงูุตูุงุญูุงุช

**ุนุถู ุนุงุฏู ุจุฏูู ุฑุชุจ:**
```
/setlang
โ Permission Denied
You need proper permissions to use this command.

Required: Server Owner, Administrator, or an allowed role.
```

**ุนุถู ูุน ุฑุชุจุฉ ูุณููุญุฉ:**
```
/setlang channel:#general
โ Shows language selection menu
```

---

## ๐ก๏ธ ุงูุฃูุงู / Security

### ุงูุญูุงูุฉ ุงููุทุจูุฉ / Implemented Protections

โ **ูุญุต ุตูุงุญูุงุช ูุฒุฏูุฌ:**
- ูุญุต ุนูู ูุณุชูู ุงูุฃูุฑ
- ูุญุต ุนูู ูุณุชูู ุงููุงุฌูุฉ ุงูุชูุงุนููุฉ (UI callback)

โ **ุนุฒู ุงูุจูุงูุงุช:**
- ูู ุณูุฑูุฑ ูู ูุงุฆูุฉ ุฑุชุจ ูููุตูุฉ
- ูุง ูููู ููุณูุฑูุฑุงุช ุฑุคูุฉ ุฃู ุชุนุฏูู ุฅุนุฏุงุฏุงุช ุจุนุถูุง

โ **ุญูุงูุฉ ุงูุฃูุงูุฑ ุงูุฅุฏุงุฑูุฉ:**
- ููุท Server Owner ู Administrator ูุณุชุทูุนูู:
  - ุฅุถุงูุฉ ุฑุชุจ (`/addrole`)
  - ุฅุฒุงูุฉ ุฑุชุจ (`/removerole`)

โ **ุณุฌู ุงูุฃุญุฏุงุซ:**
- ุฌููุน ุงูุนูููุงุช ุงูุฅุฏุงุฑูุฉ ุชูุณุฌู ูู logs
- ูุชุถูู: ุงุณู ุงูุฑุชุจุฉุ ุงูู IDุ ุงุณู ุงูุณูุฑูุฑ

---

## ๐ ุงูุชูุงูู ูุน ุงููุธุงู ุงููุฏูู / Backward Compatibility

โ **ุงูุณูุฑูุฑุงุช ุงููุฏููุฉ:**
- ุฅุฐุง ูู ูุชู ุชุนููู ุฑุชุจุ ุงููุธุงู ูุณุชุฎุฏู `manage_channels` ูุฅุนุฏุงุฏ ุงูุชุฑุงุถู
- ูุง ุญุงุฌุฉ ูุฅุนุงุฏุฉ ุฅุนุฏุงุฏ ุงูุณูุฑูุฑุงุช ุงูุญุงููุฉ

โ **ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ:**
- ุฌููุน ุฅุนุฏุงุฏุงุช ุงููุบุงุช ุงูุญุงููุฉ ุชุจูู ููุง ูู
- ูุง ููุฌุฏ ุชุฃุซูุฑ ุนูู `channels.json`

---

## ๐ ูุงุฆูุฉ ุงูุชุญูู ูููุดุฑ / Deployment Checklist

- [x] ุฅุถุงูุฉ ููู `ROLES_FILE` constant
- [x] ุฅุถุงูุฉ ุฏูุงู load/save ููุฑุชุจ
- [x] ุฅุถุงูุฉ ุฏุงูุฉ `has_permission()`
- [x] ุชุญุฏูุซ ุฌููุน ุงูุฃูุงูุฑ ุงูุฅุฏุงุฑูุฉ
- [x] ุฅุถุงูุฉ 3 ุฃูุงูุฑ ุฌุฏูุฏุฉ
- [x] ุชุญุฏูุซ ุฃูุฑ `/help`
- [x] ุชุญุฏูุซ `on_ready()` ูุชุญููู ุงูุฑุชุจ
- [x] ุงุฎุชุจุงุฑ ุงูู syntax
- [ ] ุฑูุน ุฅูู GitHub
- [ ] ุฅุนุงุฏุฉ ุชุดุบูู ุงูุจูุช ุนูู Replit
- [ ] ุงุฎุชุจุงุฑ ุงูุฃูุงูุฑ ูู ุณูุฑูุฑ ุญูููู

---

## ๐ฏ ุงูุฃูุงูุฑ ุงููุญููุฉ / Protected Commands

**ุงูุฃูุงูุฑ ุงูุชู ุชุชุทูุจ ุตูุงุญูุงุช ุงูุขู:**
1. `/setlang` - ุชุนููู ูุบุฉ ุงูููุงุฉ
2. `/removelang` - ุญุฐู ูุบุฉ ุงูููุงุฉ
3. Language selection dropdown - ุงููุงุฆูุฉ ุงูููุณุฏูุฉ ูุงุฎุชูุงุฑ ุงููุบุฉ

**ุงูุฃูุงูุฑ ุงูุฅุฏุงุฑูุฉ (Owner/Admin ููุท):**
1. `/addrole` - ุฅุถุงูุฉ ุฑุชุจุฉ
2. `/removerole` - ุฅุฒุงูุฉ ุฑุชุจุฉ
3. `/debug` - ูุนูููุงุช ุงูุชุตุญูุญ

**ุงูุฃูุงูุฑ ุงููุชุงุญุฉ ููุฌููุน:**
1. `/getlang` - ุนุฑุถ ูุบุฉ ุงูููุงุฉ
2. `/listchannels` - ุนุฑุถ ุฌููุน ุงููููุงุช ุงููููุฃุฉ
3. `/listlangs` - ุนุฑุถ ุงููุบุงุช ุงููุฏุนููุฉ
4. `/listroles` - ุนุฑุถ ุงูุฑุชุจ ุงููุณููุญุฉ
5. `/rate` - ุชูููู ุงูุจูุช
6. `/ratings` - ุนุฑุถ ุฅุญุตุงุฆูุงุช ุงูุชูููู
7. `/ping` - ูุญุต ุงูุงุชุตุงู
8. `/help` - ุนุฑุถ ุงููุณุงุนุฏุฉ

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ / Next Steps

### ูููุดุฑ / For Deployment:
1. ุฑูุน ุงูุชุญุฏูุซุงุช ุฅูู GitHub
2. ุฅุนุงุฏุฉ ุชุดุบูู ุงูุจูุช ุนูู Replit
3. ุณูุชู ูุฒุงููุฉ ุงูุฃูุงูุฑ ุงูุฌุฏูุฏุฉ ุชููุงุฆูุงู

### ููุงุฎุชุจุงุฑ / For Testing:
1. ุงุณุชุฎุฏู `/addrole` ูุฅุถุงูุฉ ุฑุชุจุฉ
2. ุฃุนุท ุนุถู ุนุงุฏู ูุฐู ุงูุฑุชุจุฉ
3. ุงุทูุจ ููู ุชุฌุฑุจุฉ `/setlang`
4. ุชุญูู ูู ุงูุตูุงุญูุงุช ุชุนูู ุจุดูู ุตุญูุญ

---

## โ ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ / FAQ

**ุณ: ูู ูููู ุฅุถุงูุฉ ุนุฏุฉ ุฑุชุจุ**
โ ูุนูุ ููููู ุฅุถุงูุฉ ุฃู ุนุฏุฏ ูู ุงูุฑุชุจ ููู ุณูุฑูุฑ.

**ุณ: ูุงุฐุง ูุญุฏุซ ุฅุฐุง ุชู ุญุฐู ุฑุชุจุฉ ูู ุงูุณูุฑูุฑุ**
โน๏ธ ุณุชุธูุฑ ูู "Deleted Role" ูู `/listroles` ููู ุชููุญ ุตูุงุญูุงุช.

**ุณ: ูู ูููู ููุฃุนุถุงุก ุงูุนุงุฏููู ุฑุคูุฉ ุงูุฑุชุจ ุงููุณููุญุฉุ**
โ ูุนูุ ุฃูุฑ `/listroles` ูุชุงุญ ููุฌููุน ููุดูุงููุฉ.

**ุณ: ูุงุฐุง ูู ูู ุฃุนูู ุฃู ุฑุชุจุ**
โน๏ธ ุงููุธุงู ุณูุณุชุฎุฏู `manage_channels` ูุตูุงุญูุฉ ุงูุชุฑุงุถูุฉ.

**ุณ: ูู ูููููู ุฅุฒุงูุฉ ุตูุงุญูุฉ ูุงูู ุงูุณูุฑูุฑุ**
โ ูุงุ ูุงูู ุงูุณูุฑูุฑ ูุงูุฃุฏููุฒ ูุฏููู ุตูุงุญูุฉ ุฏุงุฆูุฉ.

---

ุชู ุงูุชุทููุฑ ุจูุฌุงุญ! โจ
Development completed successfully! โจ
